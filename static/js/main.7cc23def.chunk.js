(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{133:function(e,a,t){e.exports=t(313)},138:function(e,a,t){},139:function(e,a,t){},313:function(e,a,t){"use strict";t.r(a);var n=t(0),r=t.n(n),i=t(49),o=t.n(i),u=(t(138),t(125)),s=t(38),c=t(128),l=t(3),d=t(10),g=t(9),v=t(11),f=t(12),m=t(13),h=(t(139),t(122)),p=t.n(h),C=(t(144),t(327)),E=t(324),b=t(129),O=t(325),S=t(88),y=t(326);function G(e,a){return e.map(function(e){return function(e,a){var t=e.units.reduce(function(e,a){return a+e},0)/e.units.length,n=(t*a.unitsGradePercentage+e.dailyGrade*a.dailyGradePercentage+e.tasksGrade*a.tasksGradePercentage)/100;return Object(l.a)({},e,{unitsGrade:t,finalGrade:n})}(e,a)})}var j=t(51),w=t.n(j),k=t(85),P=t(50),x=t.n(P),N=x.a.initializeApp({apiKey:"AIzaSyAquf-pSVDuRFdjOHK5g59Xkm4YnEW9wjk",authDomain:"students-evaluations.firebaseapp.com",databaseURL:"https://students-evaluations.firebaseio.com",projectId:"students-evaluations",storageBucket:"students-evaluations.appspot.com",messagingSenderId:"414869975779"}),R=function(){function e(){Object(g.a)(this,e),this.firestore=void 0,this.firestore=N.firestore()}return Object(d.a)(e,[{key:"saveState",value:function(e){localStorage.setItem("appState",JSON.stringify(e))}},{key:"getState",value:function(){var e=localStorage.getItem("appState");return e?JSON.parse(e):null}},{key:"saveStateOnCloud",value:function(){var e=Object(k.a)(w.a.mark(function e(a){var t;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t={state:JSON.stringify(a)},e.abrupt("return",this.firestore.collection("StudentsEvaluationsState").doc("stateKey").set(t));case 2:case"end":return e.stop()}},e,this)}));return function(a){return e.apply(this,arguments)}}()},{key:"getStateFromCloud",value:function(){var e=Object(k.a)(w.a.mark(function e(){var a,t,n,r;return w.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.firestore.collection("StudentsEvaluationsState").doc("stateKey");case 2:return a=e.sent,e.next=5,a.get();case 5:if(t=e.sent,!(n=t.data())){e.next=12;break}return r=n.state,e.abrupt("return",JSON.parse(r));case 12:return e.abrupt("return",null);case 13:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()}]),e}(),I=function(e){function a(){return Object(g.a)(this,a),Object(v.a)(this,Object(f.a)(a).apply(this,arguments))}return Object(m.a)(a,e),a}(p.a),D=new R,U={unitsGradePercentage:40,tasksGradePercentage:40,dailyGradePercentage:20},A=["Nombre alumno","Unidad 1","Unidad 2","Unidad 3","Unidad 4","Unidad 5","Unidad 6","Unidad 7","Unidad 8","Unidad 9","Unidad 10","Pruebas","Cuadernos y tareas","Observaci\xf3n diaria","Nota final"],F=function(e){var a={padding:"16px",background:e.cell.readOnly?"grey":void 0};return r.a.createElement("td",{style:a,onMouseDown:e.onMouseDown,onMouseOver:e.onMouseOver,onDoubleClick:e.onDoubleClick,className:"cell"},e.children)};function T(e){return e.map(function(e){return V(e)})}function V(e){var a=[];return a.push({value:e.id,readOnly:!0}),a.push({value:e.name}),e.units.forEach(function(e){a.push({value:e})}),a.push({value:e.unitsGrade,readOnly:!0}),a.push({value:e.tasksGrade}),a.push({value:e.dailyGrade}),a.push({value:e.finalGrade,readOnly:!0}),a}function L(e){return e.map(function(e){return function(e){var a=e.length-6+2,t=e[0].value,n=e[1].value,r=e.slice(2,a).map(function(e){return parseFloat("".concat(e.value)||"0")}),i=parseFloat("".concat(e[a].value)||"0"),o=parseFloat("".concat(e[a+1].value)||"0"),u=parseFloat("".concat(e[a+2].value)||"0"),s=parseFloat("".concat(e[a+3].value)||"0");return{id:t,name:n,units:r,unitsGrade:i,tasksGrade:o,dailyGrade:u,finalGrade:s}}(e)})}var B=function(e){function a(e){var t;return Object(g.a)(this,a),(t=Object(v.a)(this,Object(f.a)(a).call(this,e))).setUpAuth=function(){N.auth().onAuthStateChanged(function(e){console.log(e),null==e?t.props.history.push("/login"):t.loadStateFromCloud()})},t.loadStateFromCloud=function(){D.getStateFromCloud().then(function(e){e?t.setState(e):console.log("Cloud state is empty")}).catch(function(e){t.showError("Error al recuperar datos de la nube. Compruebe su conexi\xf3n a internet y recargue la p\xe1gina."),console.log(e)})},t.getEmptyState=function(){var e={name:"Lengua - Primer trimestre 2019",evaluations:[{id:1,name:"Ricardo Pall\xe1s",units:[0,0,0,0,0,0,0,0,0,0],unitsGrade:0,tasksGrade:0,dailyGrade:0,finalGrade:0}],gradesConfig:U};return{evaluations:[e],currentEvaluation:e,grid:T(e.evaluations),nextConfigCandidate:U,nextConfigCandidateValid:!0,deleteDialogShown:!1}},t.addRow=function(){var e={id:(t.state.currentEvaluation.evaluations.length>0?t.state.currentEvaluation.evaluations[t.state.currentEvaluation.evaluations.length-1].id:0)+1,name:"Ricardo Pall\xe1s",units:[0,0,0,0,0,0,0,0,0,0],unitsGrade:0,tasksGrade:0,dailyGrade:0,finalGrade:0};t.state.currentEvaluation.evaluations.push(e),t.state.grid.push(V(e)),t.updateState(t.state)},t.unitsGradeConfigChanged=function(e){var a=parseInt(e,10)||0,n=Object(l.a)({},t.state.nextConfigCandidate,{unitsGradePercentage:a});t.configPercentageChanged(n)},t.tasksGradeConfigChanged=function(e){var a=parseInt(e,10)||0,n=Object(l.a)({},t.state.nextConfigCandidate,{tasksGradePercentage:a});t.configPercentageChanged(n)},t.dailyGradeConfigChanged=function(e){var a=parseInt(e,10)||0,n=Object(l.a)({},t.state.nextConfigCandidate,{dailyGradePercentage:a});t.configPercentageChanged(n)},t.configPercentageChanged=function(e){var a;console.log(e),(a=e).unitsGradePercentage+a.tasksGradePercentage+a.dailyGradePercentage==100?t.updateState(Object(l.a)({},t.state,{nextConfigCandidate:e,currentEvaluation:Object(l.a)({},t.state.currentEvaluation,{gradesConfig:e}),nextConfigCandidateValid:!0}),function(){var a=t.state.evaluations.map(function(a){return a.name===t.state.currentEvaluation.name&&(a.gradesConfig=e),a});t.updateState(Object(l.a)({},t.state,{evaluations:a}),function(){t.updateEvaluations(t.state.currentEvaluation.evaluations,e)})}):t.updateState(Object(l.a)({},t.state,{nextConfigCandidate:e,nextConfigCandidateValid:!1}))},t.updateEvaluations=function(e,a,n){var r=G(e,a),i=T(r),o=Object(l.a)({},t.state.currentEvaluation,{evaluations:r});t.updateState(Object(l.a)({},t.state,{grid:i,currentEvaluation:o}),n)},t.deleteStudentsWithoutName=function(){var e=t.state.currentEvaluation.evaluations.filter(function(e){return e.name});t.updateState(Object(l.a)({},t.state,{deleteDialogShown:!1}),function(){t.updateEvaluations(e,t.state.currentEvaluation.gradesConfig)})},t.changeTitle=function(e){var a=Object(l.a)({},t.state.currentEvaluation,{name:e}),n=t.state.evaluations.map(function(a){return a.name===t.state.currentEvaluation.name&&(a.name=e),a});t.updateState(Object(l.a)({},t.state,{currentEvaluation:a,evaluations:n}))},t.addEvaluation=function(){var e={name:"Nueva evaluaci\xf3n "+Date.now(),evaluations:[{id:1,name:"Ricardo Pall\xe1s",units:[0,0,0,0,0,0,0,0,0,0],unitsGrade:0,tasksGrade:0,dailyGrade:0,finalGrade:0}],gradesConfig:U},a=t.state.evaluations.concat(e);t.updateState(Object(l.a)({},t.state,{evaluations:a}),function(){t.changeCurrentEvaluation(e.name)})},t.changeCurrentEvaluation=function(e){var a=t.state.currentEvaluation,n=G(a.evaluations,a.gradesConfig),r=t.state.evaluations.map(function(e){return e.name===a.name&&(e.evaluations=n),e});t.updateState(Object(l.a)({},t.state,{evaluations:r}),function(){var a=t.state.evaluations.find(function(a){return a.name===e});if(a){var n=T(a.evaluations);t.updateState(Object(l.a)({},t.state,{currentEvaluation:a,grid:n,nextConfigCandidate:a.gradesConfig}))}})},t.saveOnCloud=function(){D.saveStateOnCloud(t.state).then(function(){console.log("Saved on cloud")}).catch(function(e){t.showError("Error al guardar datos en la nube. Compruebe conexi\xf3n a internet e int\xe9ntelo otra vez."),console.log("Error while saving on cloud: ".concat(e))})},t.showError=function(e){alert(e)},t.updateState=function(e,a){t.setState(e,function(){D.saveState(e),a&&a()})},t.state=D.getState()||t.getEmptyState(),t.setUpAuth(),t.loadStateFromCloud(),t}return Object(m.a)(a,e),Object(d.a)(a,[{key:"render",value:function(){var e=this;return r.a.createElement(C.a,{height:"100%",paddingLeft:32,paddingTop:32,paddingBottom:32,paddingRight:32,background:"tint2",borderRadius:3},r.a.createElement(E.a,{name:"text-input-name",className:"title",onChange:function(a){return e.changeTitle(a.target.value)},value:this.state.currentEvaluation.name}),r.a.createElement(b.a,{className:"saveOnCloudButton",marginRight:16,appearance:"primary",onClick:this.saveOnCloud},"Guardar en la nube"),r.a.createElement(C.a,null,r.a.createElement(O.a,{width:240,marginTop:16,value:this.state.currentEvaluation.name,onChange:function(a){return e.changeCurrentEvaluation(a.target.value)}},this.state.evaluations.map(function(e){return r.a.createElement("option",{value:e.name},e.name)})),r.a.createElement(b.a,{marginRight:16,appearance:"primary",onClick:this.addEvaluation},"A\xf1adir tabla")),r.a.createElement(C.a,{marginTop:48},r.a.createElement(I,{data:this.state.grid,valueRenderer:function(e){return e.value},sheetRenderer:function(e){return r.a.createElement("table",{className:e.className},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"action-cell"}),A.map(function(e,a){return r.a.createElement("th",{key:a,className:"rotate"}," ",r.a.createElement("div",null,r.a.createElement("span",null,e," ")))}))),r.a.createElement("tbody",null,e.children))},onCellsChanged:function(a){var t=e.state.grid.map(function(e){return Object(c.a)(e)});a.forEach(function(e){e.cell;var a=e.row,n=e.col,r=e.value;t[a][n]=Object(l.a)({},t[a][n],{value:r})});var n=L(t),r=e.state.currentEvaluation.gradesConfig;e.updateEvaluations(n,r,function(){(function(e){return!!e.find(function(e){return!e.name})})(n)&&e.updateState(Object(l.a)({},e.state,{deleteDialogShown:!0}))})},cellRenderer:F})),r.a.createElement(b.a,{marginTop:16,onClick:this.addRow,appearance:"primary"},"A\xf1adir fila"),r.a.createElement(C.a,{marginTop:48},r.a.createElement(S.a,{className:"configPercentageText",width:210,marginRight:4},"Porcentaje pruebas: "),r.a.createElement(E.a,{isInvalid:!this.state.nextConfigCandidateValid,width:40,onChange:function(a){return e.unitsGradeConfigChanged(a.target.value)},value:this.state.nextConfigCandidate.unitsGradePercentage})),r.a.createElement(C.a,{marginTop:4},r.a.createElement(S.a,{className:"configPercentageText",width:210,marginRight:4},"Porcentaje cuadernos y tareas: "),r.a.createElement(E.a,{isInvalid:!this.state.nextConfigCandidateValid,width:40,onChange:function(a){return e.tasksGradeConfigChanged(a.target.value)},value:this.state.nextConfigCandidate.tasksGradePercentage})),r.a.createElement(C.a,{marginTop:4},r.a.createElement(S.a,{className:"configPercentageText",width:210,marginRight:4},"Porcentaje observaci\xf3n diaria: "),r.a.createElement(E.a,{isInvalid:!this.state.nextConfigCandidateValid,width:40,onChange:function(a){return e.dailyGradeConfigChanged(a.target.value)},value:this.state.nextConfigCandidate.dailyGradePercentage})),r.a.createElement(y.a,{isShown:this.state.deleteDialogShown,title:"Borrar almuno",intent:"danger",confirmLabel:"S\xed",cancelLabel:"No",onConfirm:this.deleteStudentsWithoutName,onCancel:function(){return e.updateState(Object(l.a)({},e.state,{deleteDialogShown:!1}))}},"\xbfDesea borrar el alumno?"))}}]),a}(r.a.Component),J=t(124),W={signInFlow:"redirect",signInSuccessUrl:"/",signInOptions:[x.a.auth.EmailAuthProvider.PROVIDER_ID]};N.auth().setPersistence(x.a.auth.Auth.Persistence.LOCAL);var K=function(e){function a(){return Object(g.a)(this,a),Object(v.a)(this,Object(f.a)(a).apply(this,arguments))}return Object(m.a)(a,e),Object(d.a)(a,[{key:"render",value:function(){return r.a.createElement(J.StyledFirebaseAuth,{uiConfig:W,firebaseAuth:N.auth()})}}]),a}(n.Component),M=function(){return r.a.createElement(u.a,null,r.a.createElement("div",null,r.a.createElement(s.a,{exact:!0,path:"/",component:B}),r.a.createElement(s.a,{exact:!0,path:"/login",component:K})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(M,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[133,1,2]]]);
//# sourceMappingURL=main.7cc23def.chunk.js.map